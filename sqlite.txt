-- write your code in SQLite 3.11.0
-- CREATE TABLE vend(country text, export numeric, import numeric);

CREATE TABLE companies2(name text PRIMARY KEY, country2 text); 
INSERT INTO companies2 VALUES('Alice s.p.','Wonderland'); 
INSERT INTO companies2 VALUES('Y-zap','Wonderland'); 
INSERT INTO companies2 VALUES('Absolute','Mathlands'); 
INSERT INTO companies2 VALUES('Arcus t.g.','Mathlands'); 
INSERT INTO companies2 VALUES('Lil Mermaid','Underwater Kingdom'); 
INSERT INTO companies2 VALUES('none at all','Nothingland');

--CREATE TABLE store1(name text PRIMARY KEY, country2 text); 

CREATE TABLE store1(id text, seller text, buyer text, value numeric, companies_name text,country text, export numeric);

INSERT INTO store1
SELECT *, sum(value)
FROM trades
LEFT JOIN companies
ON trades.seller = companies.name
--LEFT JOIN companies2
--ON trades.buyer = companies2.name
GROUP BY country;

CREATE TABLE store2(id text, seller text, buyer text, value numeric, companies_name text,country text, import numeric);

INSERT INTO store2
SELECT *, sum(value)
FROM trades
LEFT JOIN companies2
ON trades.buyer = companies2.name
GROUP BY country2;

CREATE TABLE tmp1(country text, export numeric);
CREATE TABLE tmp2(country2 text, import numeric);

INSERT INTO tmp1
SELECT country,export FROM store1;

INSERT INTO tmp2
SELECT country,import FROM store2;

CREATE TABLE out(country text);

INSERT INTO out VALUES('Wonderland'); 
INSERT INTO out VALUES('Mathlands'); 
INSERT INTO out VALUES('Underwater Kingdom'); 
INSERT INTO out VALUES('Nothingland');

--SELECT * FROM tmp2;

SELECT out.country,IFNULL(export,0),IFNULL(import,0)
FROM out
LEFT JOIN tmp1
ON out.country = tmp1.country
LEFT JOIN tmp2
ON out.country = tmp2.country2
ORDER BY out.country;